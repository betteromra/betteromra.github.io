const gamesThumbnail=document.querySelectorAll(".game-thumbnail");function unloadVideo(e){e.querySelectorAll("video").forEach((e=>{e.pause(),e.removeAttribute("src"),e.load()}))}function loadVideo(e){e.querySelectorAll("video").forEach((e=>{const t=e.getAttribute("data-src");e.setAttribute("src",t),e.load(),e.play()}))}function syncHeight(e,t){e.style.height=t.offsetHeight+20+"px",animationId=requestAnimationFrame((()=>syncHeight(e,t)))}function getChildPerRow(){return window.innerWidth<775?1:window.innerWidth<1120?2:window.innerWidth<1465?3:4}animationId=0,gamesThumbnail.forEach((e=>{e.addEventListener("click",(()=>{let t=e.parentElement;if(document.querySelectorAll(".open").forEach((e=>{e!=t&&e.classList.contains("open")&&(e.classList.remove("open"),unloadVideo(e))})),t.classList.toggle("open"),gameContentSpace=document.querySelector(".game-content-space"),gameContentSpace.style.height=0,t.classList.contains("open")){gameContent=t.querySelector(".game-content"),animationId=requestAnimationFrame((()=>syncHeight(gameContentSpace,gameContent))),setTimeout((()=>{cancelAnimationFrame(animationId),gameContentSpace.style.height=gameContent.offsetHeight+"px"}),200);const e=t.parentElement,n=getChildPerRow();index=Array.prototype.indexOf.call(e.children,t)+1;const o=Array.prototype.indexOf.call(e.children,gameContentSpace);index>o&&(index-=1),newIndexGameContentSpace=Math.ceil(index/n)*n,newIndexGameContentSpace>o&&(newIndexGameContentSpace+=1),e.insertBefore(gameContentSpace,e.children[newIndexGameContentSpace]),gameContentSpace.style.position="relative",loadVideo(t)}else gameContentSpace.style.height=0,setTimeout((()=>{gameContentSpace.style.position="absolute"}),200),unloadVideo(t)}))})),window.addEventListener("resize",(()=>{const e=document.querySelector(".game-content-space"),t=document.querySelector(".open");if(t){const n=t.parentElement;e.style.height=gameContent.offsetHeight+"px";const o=getChildPerRow();index=Array.prototype.indexOf.call(n.children,t)+1;const a=Array.prototype.indexOf.call(n.children,e);index>a&&(index-=1),newIndexGameContentSpace=Math.ceil(index/o)*o,newIndexGameContentSpace>a&&(newIndexGameContentSpace+=1),n.insertBefore(e,n.children[newIndexGameContentSpace])}}));const videos=document.querySelectorAll(".scroll-video"),observer=new IntersectionObserver((e=>{e.forEach((e=>{const t=e.target;e.isIntersecting?t.play():t.pause()}))}),{threshold:.5});videos.forEach((e=>observer.observe(e)));